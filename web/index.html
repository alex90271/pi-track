<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pi-Track Network</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body>
    <div class="app-container">
        <!-- Col 1: Icon Sidebar -->
        <aside class="icon-sidebar">
            <div class="app-logo">
                <i class="bi bi-lightning-charge-fill"></i>
            </div>

            <div class="nav-icon-btn active" data-tab="live" title="Traffic Overview">
                <i class="bi bi-speedometer2"></i>
            </div>
            <div class="nav-icon-btn" data-tab="connections" title="Active Connections">
                <i class="bi bi-diagram-3"></i>
            </div>
            <div class="nav-icon-btn" data-tab="history" title="History Log">
                <i class="bi bi-clock-history"></i>
            </div>
            <div class="nav-icon-btn" data-tab="countries" title="Countries">
                <i class="bi bi-globe"></i>
            </div>

            <div style="margin-top: auto;"></div>
            <div class="nav-icon-btn" id="db-status" title="Database Status">
                <span id="db-text"><i class="bi bi-database"></i></span>
            </div>
            <div class="nav-icon-btn" id="connection-status" title="Connection Status">
                <i class="bi bi-circle-fill" style="font-size: 8px;"></i>
            </div>
        </aside>

        <!-- Col 2: Filter/Nav Panel -->
        <aside class="filter-panel">
            <div class="filter-header">
                <div class="filter-title">Traffic Inspector</div>
                <div class="filter-subtitle" id="current-interface">eth0</div>
            </div>

            <!-- Global Stats Section -->
            <div class="panel-section">
                <div class="section-label">Throughput</div>
                <div class="mini-stats-grid">
                    <div class="mini-stat">
                        <div class="mini-stat-val" id="packets-per-sec">0</div>
                        <div class="mini-stat-label">Pkts/s</div>
                    </div>
                    <div class="mini-stat">
                        <div class="mini-stat-val" id="bytes-per-sec">0 B/s</div>
                        <div class="mini-stat-label">Rate</div>
                    </div>
                </div>
            </div>

            <div class="panel-section">
                <div class="section-label">Totals</div>
                <div class="mini-stats-grid">
                    <div class="mini-stat">
                        <div class="mini-stat-val" id="total-packets">0</div>
                        <div class="mini-stat-label">Packets</div>
                    </div>
                    <div class="mini-stat">
                        <div class="mini-stat-val" id="total-bytes">0 B</div>
                        <div class="mini-stat-label">Bytes</div>
                    </div>
                </div>
            </div>

            <!-- Protocols Section -->
            <div class="panel-section">
                <div class="section-label">Protocols</div>
                <div class="panel-chart" style="flex-wrap: wrap; gap: 10px;" id="protocol-circles">
                    <!-- JS Injected -->
                </div>
            </div>

            <!-- Filters Section (Only for Live tab really) -->
            <div class="panel-section" id="live-filters">
                <div class="section-label">Filters</div>
                <select id="time-window" class="panel-select">
                    <option value="1">Last 1 min</option>
                    <option value="5">Last 5 min</option>
                    <option value="10" selected>Last 10 min</option>
                    <option value="30">Last 30 min</option>
                </select>
                <input type="text" class="panel-input" id="packet-filter" placeholder="Search IPs, Ports...">
                <div style="display: flex; gap: 0.5rem;">
                    <button class="panel-btn" id="pause-btn">Pause</button>
                    <button class="panel-btn" id="clear-btn">Clear</button>
                </div>
            </div>

            <!-- Talkers (Mini List) -->
            <div class="panel-section">
                <div class="section-label">Top Talkers</div>
                <div class="scrollable-list" id="talker-list">
                    <!-- JS Injected -->
                </div>
            </div>
        </aside>

        <!-- Col 3: Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="content-header">
                <div>
                    <div class="content-title" id="page-title">Live Traffic</div>
                    <div style="font-size: 0.75rem; color: var(--text-secondary);">Real-time packet inspection</div>
                </div>
                <div class="content-actions">
                    <div style="font-size: 0.8rem; color: var(--text-secondary);">
                        Uptime: <span id="uptime" style="font-family: monospace;">00:00:00</span>
                    </div>
                </div>
            </header>

            <!-- Views -->

            <!-- Live View -->
            <div class="view-pane active" id="tab-live">
                <div class="table-wrapper">
                    <table class="dense-table packet-table">
                        <thead>
                            <tr>
                                <th class="col-time">Time</th>
                                <th class="col-ip">Source</th>
                                <th class="col-icon"></th>
                                <th class="col-ip">Destination</th>
                                <th>Protocol</th>
                                <th>Len</th>
                                <th>Info</th>
                            </tr>
                        </thead>
                        <tbody id="packet-table-body">
                            <!-- JS Injected -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Connections View -->
            <div class="view-pane" id="tab-connections">
                <div class="table-wrapper">
                    <table class="dense-table connections-table">
                        <thead>
                            <tr>
                                <th class="col-ip">Source</th>
                                <th class="col-icon"></th>
                                <th class="col-ip">Destination</th>
                                <th>Protocol</th>
                                <th>Packets</th>
                                <th>Bytes</th>
                                <th>Duration</th>
                            </tr>
                        </thead>
                        <tbody id="connections-table-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- History View -->
            <div class="view-pane" id="tab-history">
                <div
                    style="padding: 0.5rem; background: #fff; border-bottom: 1px solid var(--border-color); display: flex; gap: 0.5rem;">
                    <button class="panel-btn quick-filter-btn" data-days="1" style="width: auto;">24h</button>
                    <button class="panel-btn quick-filter-btn" data-days="7" style="width: auto;">7d</button>
                    <input type="text" class="panel-input" id="history-country" placeholder="Country (e.g. US)" style="margin:0; width: 120px;">
                    <input type="text" class="panel-input" id="history-filter" placeholder="Search..."
                        style="margin:0; width: 200px;">
                    <input type="datetime-local" class="panel-input" id="history-start" style="margin:0; width: auto;">
                    <input type="datetime-local" class="panel-input" id="history-end" style="margin:0; width: auto;">
                    <button class="panel-btn" id="history-search-btn" style="width: auto;">Search</button>
                </div>
                <div class="table-wrapper">
                    <table class="dense-table packet-table">
                        <thead>
                            <tr>
                                <th class="col-time">Time</th>
                                <th class="col-ip">Source</th>
                                <th class="col-icon"></th>
                                <th class="col-ip">Destination</th>
                                <th>Protocol</th>
                                <th>Len</th>
                                <th>Info</th>
                            </tr>
                        </thead>
                        <tbody id="history-table-body"></tbody>
                    </table>
                </div>
                <div class="content-footer">
                    <button class="panel-btn" id="history-prev" style="width: auto;" disabled>Previous</button>
                    <span id="history-page-info">Page 1</span>
                    <span id="history-info">0 packets</span>
                    <button class="panel-btn" id="history-next" style="width: auto;">Next</button>
                </div>
            </div>

            <!-- Countries View -->
            <div class="view-pane" id="tab-countries">
                <div class="table-wrapper">
                    <table class="dense-table">
                        <thead>
                            <tr>
                                <th style="width:50px;">Flag</th>
                                <th>Country</th>
                                <th>Code</th>
                                <th>Bytes</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody id="country-table-body"></tbody>
                    </table>
                </div>
            </div>

        </main>
    </div>
    <script src="app.js"></script>
</body>

</html>